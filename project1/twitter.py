'''
@author: Souvik Das
Institute: University at Buffalo
'''

import tweepy


class Twitter:
    def __init__(self):
        self.auth = tweepy.OAuthHandler("AC7WkBbTptQM1F9vPvaWMnPu0", "6Kv4MuuLHX3FvB0PxNLZaa1ajyIIrnGqVQriBvmYzGD8u2fD3O")
        self.auth.set_access_token("1433835629763338242-SMviK8BJ5FcBnrrYBj9CMWIoDRX8Uu", "8hcho5OJ03WadpgMjfEgvUhzX3sOJ3DNWoIvOAyqc0sdc")
        self.api = tweepy.API(self.auth, wait_on_rate_limit=True, wait_on_rate_limit_notify=True)

    def _meet_basic_tweet_requirements(self):
        '''
        Add basic tweet requirements logic, like language, country, covid type etc.
        :return: boolean
        '''
        raise NotImplementedError

    def get_tweets_by_poi_screen_name(self, screen_name):
        
        '''
        Use user_timeline api to fetch POI related tweets, some postprocessing may be required.
        :return: List
        '''
        tweets = []
        c=0
        for tweet in tweepy.Cursor(self.api.user_timeline, screen_name=screen_name, count=2500).items(2500):    
            tj=tweet._json
            txt = tj["text"]
            if txt.startswith('RT @'):
                c=c+1
                if c<200:
                    tweets.append(tj)
            else :
                tweets.append(tj)
        return tweets

    def get_tweets_by_lang_and_keyword(self,keyword):
        '''
        Use search api to fetch keywords and language related tweets, use tweepy Cursor.
        :return: List
        '''
        tweets = []
        c=0
        for tweet in tweepy.Cursor(self.api.search,q=keyword, count=7500).items(7500):  
            tj=tweet._json
            verified = tj["user"]["verified"]
            txt = tj["text"]
            if not verified:
                if txt.startswith('RT @'):
                    c=c+1
                    if c<1000:
                        tweets.append(tj)
                else :
                    tweets.append(tj)
        return tweets

    def get_replies(self,pois,keywords):
        '''
        Get replies for a particular tweet_id, use max_id and since_id.
        For more info: https://developer.twitter.com/en/docs/twitter-api/v1/tweets/timelines/guides/working-with-timelines
        :return: List
        '''
#         keys = []
#         for i in range(25):
#             keys.append(keywords[i]['name'])

#         tweets = []
#         c=0
#         poi_twids = []
#         for i in range(len(pois)):
#             sc_name = pois[i]['screen_name']
#             for tweet in tweepy.Cursor(self.api.user_timeline, screen_name=sc_name, count=3000).items(3000):    
#                 tj=tweet._json
#                 txt = tj["text"]
#                 if any(k in txt for k in keys):
#                     if txt.startswith('RT @'):
#                         c=c+1
#                         if c<2:
#                             poi_twids.append(tj['id'])
#                     else :
#                         poi_twids.append(tj['id'])
#             print(sc_name,i+1," complete")                
        
        
        
        poi_twids= [1438971071282257924, 1438563415757410307, 1437454033283866625, 1437116297192648717, 1435996498853040139, 1432373798699941890, 1430907893423894535, 1430603385825280007, 1429096019925606402, 1428363652340477968, 1427342394530451458, 1426261270718652420, 1423346832730738691, 1423013621181857799, 1422623525723152385, 1422286839457665031, 1419743573805699081, 1418257319411032067, 1418224314122395648, 1417148748577353728, 1415754050184912897, 1412861988850573323, 1412063726166056961, 1410629364727926784, 1409891919984054276, 1408527349709148165, 1405964538319708160, 1405616673588142082, 1404905743275507715, 1404091188978798592, 1403434469474832386, 1402366081910575106, 1400104926508851202, 1399803015683575809, 1396137541125001220, 1395778918737580033, 1395446727415459840, 1394705853714939913, 1394307001933500422, 1393332518838054912, 1389973312101564422, 1389239331961950213, 1388193956815638529, 1387816462744793090, 1387128173318574089, 1385279752907407368, 1384951586628251649, 1383438876778270729, 1380252596036894726, 1379483036979490824, 1379483029794607113, 1379483025763880981, 1379448862050508804, 1379448851094966278, 1378022168152391685, 1376986594104778763, 1376640364694605829, 1375522706280620032, 1375490492780150787, 1375132200295874562, 1374768479891550208, 1374740296278364163, 1372982726438092808, 1372276711065329664, 1371510056043343887, 1370471658834829317, 1369790740667265034, 1369033951587823630, 1367958119125508096, 1367537631664500737, 1367521495942053898, 1367498118200242177, 1365344161793253379, 1365034594114957312, 1362450565108797441, 1362087472436502528, 1361756230633590790, 1361729617548165124, 1361710729448067074, 1359961170510295040, 1358902150827560966, 1358874240758525954, 1357436953768116239, 1357391293786304516, 1356286566377926656, 1354887272517263365, 1354574425476243461, 1354519807673171968, 1353848055850741760, 1352028219063603202, 1350142392695988231, 1349058081225912321, 1348755323725688835, 1347619157450379269, 1346856597717446656, 1346225903039295488, 1345070785891885057, 1344769057720070144, 1344741626430816256, 1344432389834092544, 1344342593245765632, 1342943527555264515, 1341864731741724679, 1341840679354454023, 1341503792987205633, 1341503791514959873, 1339681787799334921, 1339614850155220994, 1339239149715517451, 1337453870474276867, 1335352003141230593, 1334541672747847681, 1334290759533596673, 1334265594846334978, 1333848431006191619, 1333501150482620416, 1332793900168310785, 1331689190396989447, 1331680319448223746, 1331660763979780098, 1331301578993786884, 1329529999771246593, 1329505975557087232, 1329468488688275458, 1329075541140332549, 1327371914004766720, 1326984370842906625, 1322280374911848454, 1321829320411799554, 1316789703081943042, 1314276126886330369, 1314269397121409027, 1313932608808517633, 1432287427880570883, 1419669502657056772, 1418821639903629316, 1418775070126661633, 1418185759450755074, 1417465362581364748, 1417461758655025153, 1417394850383626240, 1417057620452515843, 1417039427965112322, 1440891423121940480, 1440800018558971906, 1440449944561729546, 1440365763819282440, 1440343152984924179, 1440084297520582665, 1439751114543480838, 1439713108814139396, 1439350791345778690, 1439182418833854472, 1438987995638550534, 1438625657727209474, 1438263996117889025, 1437952243857305601, 1437901561976471561, 1437815909016559618, 1437590730818658306, 1437539188832940036, 1437177362517463048, 1436816832611041280, 1436453579301298183, 1436089027011227653, 1435727452005863429, 1435364876898164736, 1435051318700294151, 1435002652572721159, 1434841308363993089, 1434643975340703749, 1434539317964247043, 1434324990900510720, 1434278694915350531, 1433915768127823873, 1433612312439570434, 1433552751632560129, 1433244098601930752, 1433201192272896005, 1432888387510444033, 1432878373559283716, 1432828637758115840, 1432666980562001927, 1432523006044164105, 1432515984380678148, 1432465022945570824, 1432410289543290883, 1432103556102885379, 1432032801650475016, 1431942204507901954, 1431740635237781509, 1431380706815524867, 1431017090463436803, 1430855040827232257, 1430727664097185797, 1430673847305469957, 1430653996021161984, 1430342813825261568, 1430291067782455299, 1429931331522371587, 1429609334896578560, 1429590965908647938, 1429569956790915074, 1429397944424357890, 1429246948842905603, 1429206049979052034, 1429186546855399426, 1428910184274042884, 1428892107196993540, 1428842094949449730, 1428833261011279879, 1428482815881097218, 1428310782454894606, 1428167330345877505, 1428119280252555264, 1428028689489567747, 1427804581489221637, 1427758762450956290, 1427393310520487944, 1427336857860263953, 1427028672301699072, 1426837702201200642, 1426725332078546945, 1426667064077467649, 1426325192616206338, 1426308275805491201, 1426020766471106562, 1425941638157852675, 1425642201065852929, 1425583274164989959, 1425238028147175430, 1425219959215595521, 1425174425012428806, 1425130269951119362, 1424875642235932673, 1424856794300567555, 1424739747214200837, 1424569088546951170, 1424505706447839233, 1424495460505554948, 1424183758345973763, 1424165964740923392, 1424135391313989633, 1423806412212297728, 1423773377815322634, 1423770211782692878, 1423408313887244294, 1423047556309962752, 1422942907376439303, 1422717635620442118, 1422690224774209537, 1422671115516792835, 1422605692691783687, 1422385061203226631, 1422354024716673037, 1422318982019915778, 1422308726904692737, 1422022977403691009, 1421956960858083339, 1421923694922829828, 1421878390563299336, 1421594806518681605, 1421561301180903424, 1421516003893256199, 1421312160907542531, 1421284921436430340, 1421266861103230985, 1421242239318122508, 1420904473740861440, 1420869617333964807, 1420859175622565894, 1420587383981023239, 1420542085417951235, 1420507548629798913, 1420478248505458689, 1420211184112967681, 1420179697770532870, 1420145243480068100, 1420134399551574018, 1420050585835954180, 1419817311100407811, 1419790122413961218, 1419772011312672779, 1419464051957112835, 1419421149063258114, 1419371879354277896, 1419326581798051843, 1419100086491959297, 1419059102647525382, 1419054789825122310, 1418722597622063105, 1418694151433068546, 1418654649305948164, 1418367759772098560, 1418336251703300096, 1418322461716664321, 1418308403726856192, 1418308391361994762, 1417970214491262976, 1417960072135811072, 1417914776752070656, 1417642983499784192, 1417607820707602442, 1417597684731432961, 1417593548233347073, 1417244651325698050, 1417235297247580161, 1417189998554599425, 1417140995658031109, 1416910656947720197, 1416883860542005249, 1416593575651909633, 1416526612124901378, 1416457673608810499, 1416197473840812032, 1416193431198527490, 1416158201268117507, 1416148134804164609, 1415876341640138760, 1415795111309500428, 1415785746678509568, 1415749934544998411, 1415740447587241987, 1415521504377331717, 1415488546740264960, 1415433121500106757, 1415362959497318401, 1415071809540694017, 1414960477071888390, 1414767711880728576, 1414708140445212673, 1414386301424574470, 1414350416112984065, 1413986165196210180, 1413620746010730498, 1413318319441072130, 1413259393483911170, 1413154443495972867, 1412895718663204865, 1412537611797868545, 1412172085766635531, 1412113322384711682, 1411870049531465735, 1411810650872061952, 1411496651840274433, 1411448548558786560, 1411140801741066248, 1411083367580422152, 1410970780905656326, 1410728746382811136, 1410364170558754830, 1409996946325000192, 1409886747471851530, 1420943037371453448, 1419166950505304064, 1418442277459042306, 1407646976879980545, 1405398806414254084, 1405044850148339714, 1404670434990116868, 1400684938857308165, 1399943800827518976, 1399222252504326146, 1398206822541103104, 1396757094758486020, 1391017108646113284, 1389533293847224325, 1389460233295106049, 1389438109176274944, 1389076647148720131, 1388442654258642947, 1386266698496593923, 1385446229383987200, 1384878227051720709, 1383413292920545287, 1372737708049657856, 1340158221852413952, 1330463976942043136, 1315261119045398533, 1299308467711168512, 1281486711504211968, 1268888815340421122, 1268376270867292160, 1257928969925488645, 1257619395288772610, 1251352745824550912, 1249713269184401409, 1247092935293689857, 1246378849027252224, 1244250414943363072, 1243501906632343553, 1242758218192793600, 1241384490145964033, 1241306304506769408, 1240219741333020677, 1238331274726486017, 1235479539666399234, 1223090544609333249, 898902527093100546, 1426548957073731593, 1426543862898589696, 1426538546492366852, 1419908051537072128, 1409085612683001858, 1409084605190184962, 1409032055887781888, 1373589393252913156, 1358281985634889729, 1357630228982472705, 1355050338114433030, 1355044153822830595, 1355043895533465601, 1355043040981733376, 1355043013232189444, 1355040528040034310, 1355027975675121664, 1353705420045443073, 1353704375756050434, 1353704122424336387, 1353703670471217152, 1353703247769264128, 1353700851336900609, 1353698359001796610, 1347877721494278146, 1347877481987014658, 1344164825652371456, 1344163974468624386, 1331943117168132096, 1331943051808309249, 1309387077902008320, 1294276730484482049, 1294275333139529729, 1294275264382291968, 1294274858134601728, 1294274538142744576, 1294274412238135296, 1294272824245248000, 1294269223649202176, 1294268863907946496, 1294266667761950721, 1279270103947730945, 1279268029147172864, 1268763269860188160, 1263377068500193286, 1246034709651456000, 1240910726006329345, 1240904022359302151, 1240901346787639296, 1238074814020997121, 1235561663794802688, 1235180570621005824, 1439511488733978636, 1437419215804243973, 1423685754421596164, 1422552592375296019, 1408092303256743941, 1407008533107773440, 1407008213497638913, 1404713801975435268, 1404364887728398337, 1399592894495744001, 1399549292398841858, 1399548939292987397, 1388375527543635968, 1386962003881721856, 1386273312192352261, 1386272839460790274, 1384417743802302467, 1384404970259193856, 1364925853201653767, 1363349660128059393, 1352568932297805824, 1350334703987875842, 1350318219760791556, 1350307437803315200, 1350275376061116416, 1348513228557488128, 1348168467367694339, 1330846651905261569, 1330846474972790786, 1330144872909705221, 1322779386345529346, 1434852067823083523, 1434852046595715087, 1434851961547866120, 1425772248518909956, 1413459216619081728, 1398926714475102209, 1398925898640994306, 1392507730376544258, 1392032291996639235, 1391057009240252418, 1389571662455136264, 1388814026793123842, 1388813843543982083, 1387362890085064704, 1386239404646100992, 1385891002209038343, 1385622094810030081, 1385186788927438855, 1384815961375531010, 1383456612027752455, 1379845603476205570, 1365318008474898437, 1355830677761998848, 1354804658963767299, 1352794874567921664, 1352277819494080514, 1350350933901910017, 1349710409062731776, 1337695935757873154, 1329341675265609728, 1324390223619354625, 1309891938695274496, 1441021026494599177, 1440779171593015296, 1438256114563534851, 1428499521059790852, 1424745272077324289, 1420875940415037442, 1418987708496719872, 1414343389093548036, 1402732235955085319, 1399816170950303749, 1396973200836268035, 1391158470062247939, 1390395963097993226, 1388523610550243335, 1386692051723603979, 1378844833889009666, 1377374081285201921, 1376670509300129796, 1375133496780406785, 1374058293476401155, 1371843414468268038, 1371609144575266817, 1370491036431048711, 1369475982160183303, 1368652678247510018, 1366765238645841920, 1366419166815801347, 1362525015179223044, 1360608347897135112, 1360311331434430467, 1359654292450385928, 1359522409741770759, 1359171049137598466, 1358830674531262467, 1357771176391548928, 1355893193561284610, 1352773702308474880, 1350241809012830213, 1349790884691374090, 1346167722376273920, 1345807854465392653, 1344820891566354434, 1344758913607077888, 1343293429816573953, 1341388889949290496, 1340131004271321094, 1338917675573997568, 1338559406712090624, 1337577041290436609, 1337151976807649285, 1336864892779782145, 1335746175551488004, 1335377985419931649, 1335293509553680384, 1334937721597382656, 1334663740998860800, 1333852989870792705, 1333580909656690688, 1333211215166799874, 1333107305429176323, 1332842706930782208, 1332051600911724544, 1331661777201819648, 1331377827761963008, 1331285528889716745, 1331024951118204931, 1330679503383789570, 1330247138073325569, 1329855517636878339, 1329577237839044609, 1329124575959986176, 1328795596740845568, 1328524796276117505, 1328147620171280384, 1328042639292305410, 1327793353371607041, 1326965393093701641, 1322349604189470720, 1321627844607430664, 1320159433931063301, 1317923720980291592, 1317135128284508164, 1316205632912064513, 1315069899144798209, 1313640491863412741, 1312476071669841921, 1311487686600003586, 1309310534899183623, 1308957046616793088, 1308923369023299584, 1308449907762757634, 1308166481910419456, 1306416247584817154, 1305271548325040128, 1305213983834738688, 1303439168094306306, 1302781584077094913, 1302060479251181568, 1301964490095955968, 1301265343202177030, 1300610939436306435, 1300256618169413633, 1299830984481943558, 1298734600664088577, 1298438631921721346, 1296839720832569344, 1296122303902777344, 1295426138227998720, 1295028206857314304, 1294089657064534018, 1292926334541467653, 1292833199085821952, 1292610003434721280, 1292572873257897984, 1291866984951537664, 1290076715025227776, 1290020044433285120, 1287903073520812032, 1287053903197089796, 1286773674239053825, 1286720650959364096, 1285978641520828418, 1285625081155268609, 1285383290799763457, 1283835135872454658, 1283495017848492038, 1282692547098357760, 1282364848677040129, 1282133673807097859, 1281978220502495233, 1279212377976844290, 1278762201197789184, 1278151865243512832, 1278082957207646213, 1276521861975650305, 1276163410678423556, 1275092295654801408, 1268004722063048711, 1266072275335417858, 1265763380310269953, 1264377887253200902, 1263928426869796868, 1263604763305873409, 1263561239541747712, 1262839836894953474, 1261427622296371208, 1261024427472564224, 1260979740879585281, 1260695263439654916, 1259889852876820481, 1259598065830449153, 1258516197378650113, 1258083207955845122, 1257821916829794305, 1256986601391099905, 1256689312072192001, 1255540474082988038, 1254919706856902662, 1254424724970618881, 1254220207935164426, 1254066531085975553, 1253707025348993025, 1253451577806983168, 1253075570293977093, 1253016036695302144, 1252680429339136005, 1252592609719181312, 1252377702608146434, 1252353741522522117, 1252314748466626561, 1251908242436997122, 1250967253325090817, 1250801180512595972, 1250524298764263425, 1250486319286976522, 1250232420789518337, 1250205567756500993, 1250114339446689792, 1250064059061370882, 1249694204881711104, 1249103010149453826, 1249053138541318145, 1248691102737186817, 1248437907507032064, 1248277304092037120, 1247566157219016709, 1247339981816893440, 1247296680401219591, 1246944849200386049, 1246879039446450176, 1245875246407856133, 1245840192877072385, 1245448011565674497, 1245383240074113031, 1245350014358097921, 1245130216676167680, 1245069015011246085, 1245043975741943813, 1243955802827902977, 1243598253129699328, 1243218556399112201, 1242986185502457864, 1242619836758458368, 1242576103996260354, 1242559554073899008, 1242235440930979841, 1241863046923943946, 1241725125591994368, 1241182272868495360, 1241067863567413249, 1240795044522659841, 1240730881070956545, 1240696668158193665, 1240680936175534080, 1240442416030777345, 1240370454306717698, 1240334097731502080, 1240313879596539905, 1240033649300561922, 1239985233753190400, 1239946668990246912, 1239732657522704384, 1239661758245208071, 1239618122480594947, 1239600314241765378, 1239240692515459085, 1238945066158358528, 1238879621644460033, 1238544226817912839, 1238499572449783814, 1238269560224124928, 1237421056358518785, 1237374191546089472, 1236789987678568448, 1236097673691832320, 1235225793527246848, 1234674218622570498, 1233921130404163585, 1233482850575560705, 1232820098362150912, 1420406148671361025, 1404439115962191875, 1403342391600418816, 1390291977011400704, 1383174734322528256, 1379810258525155330, 1379809113513848834, 1379575786668228612, 1363153306898616325, 1362862424970436615, 1358854621188526082, 1354220988850982912, 1353840725771890689, 1351607207138390021, 1347977414211727366, 1346200269818896386, 1343219180032708613, 1337450091913895936, 1337128299831717888, 1336486365773565952, 1334297762767265793, 1323046379242037249, 1322686123374714880, 1320830040754499590, 1320755616319709185, 1320355290169167874, 1318996387745484801, 1318602854492491776, 1317509800893272068, 1316373231947874305, 1312023288160432131, 1311704074417590273, 1310972693861330945, 1295734451570380801, 1295349516011556867, 1294718617326583808, 1293208216189505536, 1291450500907442177, 1291204377223540736, 1291156120489336832, 1291086690656952320, 1290291783088431104, 1289244069365870594, 1288819009815805955, 1288252231767162880, 1285606181181022217, 1285366832241803264, 1285281549311778817, 1284119328946827269, 1284101333084143620, 1283836368024739841, 1283088539488591872, 1283070182563418112, 1283022197230108678, 1281739735073947652, 1280538189267177472, 1279557183978582018, 1278459150318608385, 1277987460929159169, 1277256887101280256, 1276891652569866245, 1275184046482522115, 1272555634580426753, 1271832696017293312, 1270350499003449344, 1269291721600446466, 1268578259693903873, 1268284211255037954, 1268208644618936321, 1267126362365542400, 1266755860388147203, 1266731947029659649, 1266419617506848768, 1266414733202124800, 1266403464709656576, 1266036034338533377, 1266032480152403968, 1266029566599892992, 1266005699500351490, 1265694302325420040, 1265689609679171586, 1265654796507381761, 1265304578129399808, 1265285626829643779, 1264942324787732484, 1264921717077692416, 1264586961387352066, 1264569972317204484, 1264218372796899328, 1264208426898522112, 1263847732315254786, 1263830819505950722, 1263531787290062855, 1263493461384114181, 1263470535801032705, 1263134957502947328, 1263134330777468928, 1263130799970250752, 1263109170351480832, 1262775616668962816, 1262755425457299456, 1262405484578889728, 1262384388957966336, 1262050439861686278, 1262030676607590408, 1261681009310883841, 1261672650306392064, 1261326360313724930, 1261319223239819265, 1261313133156556801, 1261290508401467392, 1260993868327088129, 1260974152971948032, 1260915461367173121, 1260602272549142528, 1435739980706500609, 1433891056953790482, 1426676508349943815, 1425984566012092422, 1410989575732961286, 1410694898601316359, 1404230838619979784, 1402391817065308168, 1400913089164365831, 1395772093422317579, 1394459502011891712, 1350256455748882434, 1349872996920430595, 1349563892087869442, 1344093345207832576, 1344021093321826305, 1343734732282974208, 1336770593987899394, 1336495783038701568, 1336383784128708609, 1336003791183818753, 1335758425284874240, 1332855798272147457, 1332730472351240192, 1332493158882496512, 1331761084873789440, 1331716793149304845, 1331661304512253954, 1331631229414772738, 1329939582633250819, 1329531656894484480, 1329206502414958593, 1329130715439525889, 1325885871875190784, 1325880083618426881, 1325842292444291072, 1325253706061926401, 1323454098025320448, 1323052200814366720, 1322971669355483139, 1322952795033538560, 1322620606098137088, 1322254443644026880, 1321491263334436864, 1321474305004236800, 1321232710711582720, 1320130447649636352, 1319723264927649792, 1319448963443982337, 1318701028997517314, 1318598926262480898, 1317589957704355843, 1316894374500962305, 1315046951440838656, 1314922380528095232, 1314714747762335746, 1314608059482865667, 1314393898333208578, 1314011006650273792, 1313582048691458048, 1313275529064316928, 1312206233038974976, 1310003720164384782, 1309949613533659136, 1309540165862535172, 1308541590382682113, 1308451240838344706, 1308423054834401281, 1308394869153361926, 1308195555940749316, 1307775538237333504, 1306384874643894272, 1302396094886813698, 1301990709910794243, 1301237205617135617, 1299846890725560323, 1299172852760014848, 1297694360545484801, 1297667433239470081, 1295759864648609795, 1295539662631645189, 1294787205030846465, 1294350074399449089, 1293517596323655680, 1293215600680951810, 1293175334037262336, 1292870827168342017, 1292207707894685696, 1291784921841688578, 1291690890566737920, 1290675360682500096, 1290610936022171655, 1289932717417734144, 1288564199723921408, 1287908127476551680, 1287764429703188482, 1287070108465139713, 1283918085288652800, 1283412252612194304, 1280998849730039810, 1280950782909538304, 1279154194709016576, 1278809602763751424, 1278498625069502465, 1276569916427120640, 1276539465830449154, 1276296615377145856, 1276271018143879168, 1275941587596595200, 1274362370375274496, 1274115997029421056, 1272989827282001921, 1272911057330167813, 1271604689809833991, 1270860797938466818, 1266844333006700550, 1265689220603150337, 1264632385691410433, 1262548526094929928, 1261408054093860865, 1260751685959417858, 1260744136212140034, 1260664864269381635, 1260303075111325697, 1259855842041565186, 1259228398615846913, 1258063979412250628, 1257818848591351809, 1256727670554914818, 1256667024912244736, 1256355216934547456, 1255670706463006731, 1428507373174501382, 1423682493933314056, 1410761020029562882, 1396264194077609987, 1394396428043231240, 1393292006215069697, 1387412847001538562, 1384589230903422978, 1371519498688290838, 1359724917470724096, 1354632706966122497, 1354281284554657792, 1345788544313417729, 1330724391940993026, 1300598883370725376, 1293687679490629638, 1288984635662376962, 1285274622003425281, 1284164472538632194, 1270768394896277512, 1268918265138622467, 1265376812567269390, 1258049634972336128, 1257390602490167297, 1256716585689141253, 1255544413251604483, 1255349333429551107, 1254935203795042307, 1254149501956296712, 1253077403754250240, 1248770901019148288, 1248484666706808833, 1248034499688103936, 1247723236353327104, 1247684351837581312, 1247297567949492226, 1247187827609272320, 1246949751389597696, 1246915084825264129, 1246876975580487686, 1246290075048124417, 1246239701708738561, 1246089955484610561, 1245974934859517953, 1245827464917594113, 1245816189793771521, 1245595630103195649, 1245409113577848832, 1243709173868703746, 1243144541588291586, 1242913684697088006, 1242648137258409984, 1241532486829641729, 1241195616111337472, 1240143837722562560, 1239706742218543104, 1239690646320893952, 1239288568809508871, 1239254089365667841, 1238962056461791238, 1236742659156385794, 1236113277060558848, 1235269583264796674, 1230585115526520833, 1230225300405080064, 1221597807603322882, 1438336845964738566, 1434950965535277059, 1430702727471017986, 1430226159615180806, 1429869993022394368, 1427705836282032136, 1427705827377520642, 1425227056330256392, 1424444337287434245, 1423332199386996743, 1422623233212239876, 1419054787543408648, 1417623151006011392, 1417619413872779264, 1416409986515750915, 1415739072795090944, 1413286787313721344, 1413265751281184772, 1413245161203806213, 1413206106357313536, 1413165991798972418, 1413120748441542658, 1412827561806028803, 1412812308372414464, 1412809880675704835, 1412508516020011016, 1407384132347441161, 1406045144550313988, 1404811392079826949, 1404517088388128768, 1404516328384438274, 1403064588955013127, 1398338238545268738, 1397654074216968192, 1396898055673335808, 1396536699048677380, 1395468301522903041, 1395078666548350976, 1394731949093265409, 1394663500157435906, 1394003714202030084, 1393614511505133570, 1390369474864353286, 1389767073119850500, 1389590116717539328, 1385622866121486336, 1382425798091669508, 1382403177224536066, 1380578253732200454, 1379143347714031616, 1376972320477229062, 1374181544617721860, 1374181417190580224, 1370455676040937481, 1365380656113610757, 1365023513673875460, 1363206756411785217, 1362844403132297216, 1360024700051677192, 1359964651208011779, 1358116250388422656, 1357067713084973056, 1438255133897510912, 1433140294355230726, 1430649784193409024, 1430211646274818048, 1427298571448115202, 1426944271815380994, 1425947705860190211, 1424767669513900035, 1423713980791492609, 1423475548433666048, 1423437439557898243, 1421875953056239616, 1421268345257611265, 1420452134236172298, 1420452130754809857, 1419041660592345088, 1415333548328947724, 1413576185628532740, 1410353587868340226, 1409890414509932545, 1407103359199465473, 1406992662188773385, 1406667436871540738, 1405905290600517635, 1404455914015531008, 1403032326255353863, 1400507447027118083, 1399495733053739011, 1399383667533881350, 1396602834871889923, 1396586735346257923, 1396163952388624386, 1395397644470652935, 1394737107483217929, 1394369678319947777, 1394001755591958528, 1393679333479301120, 1393300276677947398, 1393300263209951233, 1390062450356199430, 1389699384074452997, 1388584585257177090, 1388545358284959745, 1388248726129491969, 1387848341191643141, 1387590385187307527, 1387590369811079171, 1387229814311067653, 1386716362400223233, 1385323166638166021, 1383240880585207811, 1382531191794933769, 1382485341559472130, 1382091218432180229, 1381787428634103817, 1381719416879071245, 1380334274784690176, 1379997844162158592, 1376745719630028801, 1374522984279404544, 1372354461163741187, 1371942077047701507, 1370041672071925761, 1366189153776513029, 1365724219343048708, 1364404340660690947, 1364327823859613705, 1363621649115844608, 1363612660839763968, 1361863363869949953, 1361133914551693317, 1361133838987051010, 1360389239096156160, 1360350749230825477, 1360302693613334536, 1360004526699331584, 1356000299408879616, 1355969720567148544, 1355212087056863235, 1353456409665441795, 1352352987595812866, 1350533279649173504, 1349525701507096577, 1344034426913779713, 1441067441153576960, 1440352394475290626, 1438533185533628424, 1437089376241061891, 1435481475256922112, 1435256752388333568, 1434894293337051136, 1433892332450025496, 1433608851316748289, 1431391197700964352, 1429096464177848323, 1426942870137802755, 1426640903461122049, 1426579578676523013, 1425840728152940546, 1425154326079676417, 1424780700998422528, 1424748510608515075, 1423107266362941442, 1421591554293108740, 1421126342473572353, 1420828567521333250, 1420763133686304768, 1419108836166750215, 1418949258418524172, 1418225748041560070, 1418204953684889600, 1417862073913126912, 1416057382803804164, 1415700122323886082, 1415412556194320392, 1415082431019954183, 1415008560212291591, 1413981681640484865, 1413515712501407745, 1413279469758992389, 1412838283604893699, 1412563529719287810, 1412201680226168839, 1412096494853894146, 1411113139412865026, 1411082409836171270, 1410387711798697987, 1410002909396414465, 1409919857903210505, 1409587188988145665, 1408953571790499841, 1408902421032718338, 1408077489230974979, 1407096072657309697, 1407036120693719041, 1406061873515175937, 1405628572748898315, 1405314332628553731, 1404951968444002304, 1404559384382935044, 1404454443433799682, 1404227517242826754, 1404197074871197699, 1403728841210798091, 1403503063462207490, 1403366569523175425, 1403079616043098114, 1402777649043365888, 1402641873341227009, 1402114368301588480, 1401328064013889540, 1401237474286964745, 1400829782456258569, 1400543171403292672, 1400195567570014216, 1400104952706605062, 1399439852190547969, 1399380254070878213, 1398486183303331841, 1398383034102173697, 1398043864573923332, 1398008872749748225, 1397930649474854912, 1397568270807490563, 1396950943191781390, 1396927864843522050, 1396880448756887552, 1396616987795722242, 1396166385710112768, 1396118730762031105, 1395851022573182981, 1395817136229130252, 1395454694651277314, 1395137287445483530, 1394750782969352197, 1394445247376203780, 1394306804377604100, 1393944439316492291, 1393687667741708292, 1392942125856301061, 1392911536784609284, 1392132409399914501, 1391490888455573507, 1391451880732176389, 1391120900754378752, 1390682863226474499, 1390437585684733957, 1390415381072908288, 1389671455340777486, 1389280524221435911, 1388588935085965318, 1388561419411546118, 1388221714354552842, 1387473392752865286, 1387068500687179781, 1386698834269675525, 1386130812244946949, 1386101203008847873, 1384645918855729152, 1384522293808934914, 1384265667499548674, 1384235526354472970, 1383933658352873481, 1383543424381452293, 1383178465994702849, 1382786061848485894, 1382756459193192448, 1382710374731026433, 1382400640144470016, 1382346749197619208, 1382091872450048003, 1381985669690621954, 1381784106929954818, 1381731955423731718, 1381269261147111425, 1381011732139741192, 1380988209946038272, 1380898465522257927, 1380205288599457797, 1379947249258659840, 1379149613052088320, 1378789469399179270, 1378093104008421378, 1376611183365660672, 1375538285775360011, 1375165975990050824, 1374858905340219402, 1374798225534767110, 1374496239039827974, 1374420993792385039, 1374396020004560896, 1374168691529682946, 1374122308693065736, 1374089355447402498, 1374060151708266509, 1374030464458104833, 1373665956149534721, 1372941048578773004, 1371899154478301194, 1371857767787532299, 1371280325343580161, 1370902602817355785, 1370132482604032012, 1369815445591765000, 1369723668796997636, 1369378054624120836, 1369090891697299456, 1369017140662185989, 1368734253186494467, 1368577263835488264, 1368021543494836226, 1367868014008340482, 1367611327179538435, 1365845936249970688, 1365481847447257096, 1364260136148205569, 1363156802679042048, 1362840145960046594, 1362431104964309004, 1362121402892042243, 1361782999512195072, 1361707866265186316, 1361465766961381377, 1361136195753943041, 1360264947561857027, 1358269460927418368, 1356045615822729220, 1352373938047905795, 1350630533336805390, 1350578797641428993, 1350514418967261184, 1350132974231158786, 1349787963052478464, 1349531626435465217, 1349510226089832449, 1349411153949184003, 1349370738604711939, 1349174419772600320, 1349151829637128195, 1349114040254144512, 1349099285867065345, 1349076044821770241, 1349027540455854083, 1348736337734725633, 1348435984871022594, 1348404472217788423, 1348361759091023873, 1348313947527667713, 1345173187378733060, 1341051242383085568, 1340326102573703170, 1337789330132246529, 1334633692455727114, 1333576661724520449, 1332489704449712129, 1332143082645692416, 1331957473952079874, 1330675965232558082, 1330178846486913026, 1328839372083499011, 1328153195206545409, 1325929138885177344, 1325530289322549258, 1325530287816708097, 1324381022469967873, 1323071830660419584, 1323007049924562947, 1322570194414428162, 1321891427647950848, 1321644571340713984, 1321539365764550656, 1321312179413569536, 1321262929061138432, 1321145996353720332, 1320553832653426689, 1318366538165092353, 1318258309821026305, 1317080635295604737, 1312196008634322944, 1311455835487428609, 1311108797868519426, 1310309255623381000, 1310293233877094400, 1432840628048576514, 1432677764390395906, 1381004850100535297, 1379406396987424772, 1337829604174655488, 1323611558677630980, 1322599477585219585, 1321075199698087941]
        print("covid tweets",len(poi_twids))
        
        for i in range(1):
            idd=poi_twids[i]
            print(type(idd))
            for tweet in tweepy.Cursor(self.api.search,q='to:{}'.format(screen_name),since_id= idd,count=1000).items(1000): 

                tj = tweet._json
                txt = tj["text"]                
                repts = tj["in_reply_to_status_id"] 
                print(type(repts))
                if repts == idd:
                    if txt.startswith('RT @'):
                        c=c+1
                        if c<5:
                            tweets.append(tj)
                    else :
                        tweets.append(tj)

            print(idd," ",len(tweets))     
                 
#         print("tot: ",len(tweets))
        return tweets
